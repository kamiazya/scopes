# Lefthook configuration for Scopes project
# https://github.com/evilmartians/lefthook

pre-commit:
  parallel: true
  commands:
    markdownlint:
      glob: "*.md"
      exclude: '.claude/.*|tmp/.*'
      run: |
        docker run --rm -v "$(pwd):/workspace" \
          -w /workspace \
          davidanson/markdownlint-cli2:latest \
          --config /workspace/.markdownlint.json \
          --fix \
          --disable MD051 \
          {staged_files}
      stage_fixed: true
      skip:
        - merge
        - rebase

    editorconfig:
      glob: "*"
      exclude: '.claude/.*'
      run: |
        docker run --rm -v "$(pwd):/workspace" \
          -w /workspace \
          mstruebing/editorconfig-checker:latest \
          ec \
          {staged_files}
      skip:
        - merge
        - rebase

    ktlint:
      glob: "*.kt"
      run: ./gradlew ktlintFormat --daemon
      stage_fixed: true
      skip:
        - merge
        - rebase

    detekt:
      glob: "*.kt"
      run: ./gradlew detekt --daemon
      skip:
        - merge
        - rebase

    kotlin-test:
      glob: "*.kt"
      run: ./gradlew test --daemon
      skip:
        - merge
        - rebase

# Skip hooks during CI/CD
skip_output:
  - meta
  - success
